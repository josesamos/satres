<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="satres">
<title>Selecting and transforming satellite bands • satres</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Selecting and transforming satellite bands">
<meta property="og:description" content="satres">
<meta property="og:image" content="https://josesamos.github.io/satres/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">satres</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.1</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../articles/satres.html">Get started</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/v10-transf.html">Selecting and transforming satellite bands</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/josesamos/satres/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Selecting and transforming satellite bands</h1>
                        <h4 data-toc-skip class="author">Jose Samos (<a href="mailto:jsamos@ugr.es" class="email">jsamos@ugr.es</a>)</h4>
            
            <h4 data-toc-skip class="date">2023-10-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/josesamos/satres/blob/HEAD/vignettes/v10-transf.Rmd" class="external-link"><code>vignettes/v10-transf.Rmd</code></a></small>
      <div class="d-none name"><code>v10-transf.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In the vignette titled <em>Grouping satellite bands by spectral and
spatial resolution</em>, <code><a href="../articles/satres.html">vignette("satres")</a></code>, the
<code>satres</code> package is presented. It shows how to create objects
of the <code>satres</code> class from raster files corresponding to
satellite bands. It also shows how to save the data to files or export
it to work with the <a href="https://CRAN.R-project.org/package=terra" class="external-link"><code>terra</code></a>
package.</p>
<p>The main objective of this document is to show the functions
available in the <code>satres</code> package to select and transform the
satellite bands contained in <code>satres</code> class objects before
storing or exporting them.</p>
<p>First, the example data and object creation functions are presented.
Then, the functions that allow us to select bands are shown. Continues
with other functions to transform the bands. Finally, it ends with the
conclusions.</p>
</div>
<div class="section level2">
<h2 id="data-and-object-creation">Data and object creation<a class="anchor" aria-label="anchor" href="#data-and-object-creation"></a>
</h2>
<p>In this section we discuss the data that we used in the examples, the
objects of the <code>satres</code> class that we created and and we
compare the results obtained.</p>
<div class="section level3">
<h3 id="data">Data<a class="anchor" aria-label="anchor" href="#data"></a>
</h3>
<p>The data we are going to use is the same as in vignette <em>Grouping
satellite bands by spectral and spatial resolution</em>,
<code><a href="../articles/satres.html">vignette("satres")</a></code>: Two compressed files of bands from the
<em>Sentinel-2</em> satellite (obtained from <a href="https://dataspace.copernicus.eu/" class="external-link"><em>ESA</em></a> website)
covering the municipality of Lanjarón in Granada (Spain) that, once
unzipped, have been added with a factor of 100 (data resolution has been
multiplied by 100) to be included in the package. We access the folders
that contain them using the following function calls:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">esa</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"esa"</span>, package <span class="op">=</span> <span class="st">"satres"</span><span class="op">)</span></span>
<span><span class="va">esa_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"esa/f"</span>, package <span class="op">=</span> <span class="st">"satres"</span><span class="op">)</span></span>
<span><span class="va">esa_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"esa/g"</span>, package <span class="op">=</span> <span class="st">"satres"</span><span class="op">)</span></span></code></pre></div>
<p>We are also going to work with a vector layer of polygons with the
outline of the municipality of Lanjarón, which has also been included in
the package in <em>GeoPackage</em> format. We access the file using the
following function call:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lanjaron_gpkg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"lanjaron.gpkg"</span>, package <span class="op">=</span> <span class="st">"satres"</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="creation-of-objects-of-the-satres-class">Creation of objects of the <code>satres</code> class<a class="anchor" aria-label="anchor" href="#creation-of-objects-of-the-satres-class"></a>
</h3>
<p>To create an object we only need to indicate the folder that contains
the satellite band files.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/satres.html">satres</a></span><span class="op">(</span>dir <span class="op">=</span> <span class="va">esa</span><span class="op">)</span></span></code></pre></div>
<p>By default, only the satellite spectral bands (<em>B01</em> to
<em>B12</em>) are considered. If we want all available bands to be
included, we have to indicate it using the
<code>only_spectral_bands</code> parameter, as shown below.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sr_all</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/satres.html">satres</a></span><span class="op">(</span>dir <span class="op">=</span> <span class="va">esa</span>, only_spectral_bands <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p>In both cases, since all the files are contained in the same folder
(regardless of how deep they are in the folder structure), the rasters
that were tiles of the same work area have been merged.</p>
<p>In the same way, we can create independent objects with each of the
folders. In this case, we are only going to consider the spectral
bands.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sr_f</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/satres.html">satres</a></span><span class="op">(</span>dir <span class="op">=</span> <span class="va">esa_f</span><span class="op">)</span></span>
<span><span class="va">sr_g</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/satres.html">satres</a></span><span class="op">(</span>dir <span class="op">=</span> <span class="va">esa_g</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="results-obtained">Results obtained<a class="anchor" aria-label="anchor" href="#results-obtained"></a>
</h3>
<p>We can see the results obtained so far by consulting the available
spatial resolutions (it will be the same for all objects) and obtaining
objects of class <code>SpatRaster</code>, as shown below.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sr</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_spatial_resolution.html">get_spatial_resolution</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "r1000m" "r2000m" "r6000m"</span></span>
<span></span>
<span><span class="va">r_1000m</span> <span class="op">&lt;-</span> <span class="va">sr</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/as_SpatRaster.html">as_SpatRaster</a></span><span class="op">(</span><span class="st">"r1000m"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r_all_1000m</span> <span class="op">&lt;-</span> <span class="va">sr_all</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/as_SpatRaster.html">as_SpatRaster</a></span><span class="op">(</span><span class="st">"r1000m"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r_f_1000m</span> <span class="op">&lt;-</span> <span class="va">sr_f</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/as_SpatRaster.html">as_SpatRaster</a></span><span class="op">(</span><span class="st">"r1000m"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">r_g_1000m</span> <span class="op">&lt;-</span> <span class="va">sr_g</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/as_SpatRaster.html">as_SpatRaster</a></span><span class="op">(</span><span class="st">"r1000m"</span><span class="op">)</span></span></code></pre></div>
<p>Below are the band names available for that resolution. Firstly, for
the case in which we have only considered the spectral bands, then if we
have considered all the bands.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">r_1000m</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "B02" "B03" "B04" "B08"</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">r_all_1000m</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "AOT"            "B02"            "B03"            "B04"           </span></span>
<span><span class="co">#&gt;  [5] "B08"            "MSK_DETFOO_B02" "MSK_DETFOO_B03" "MSK_DETFOO_B04"</span></span>
<span><span class="co">#&gt;  [9] "MSK_DETFOO_B08" "WVP"</span></span></code></pre></div>
<p>To see the differences between the other objects, for each object, we
are going to show one of the bands for that resolution.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_1000m</span><span class="op">[[</span><span class="st">"B02"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="v10-transf_files/figure-html/unnamed-chunk-9-1.png" width="700"></p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_g_1000m</span><span class="op">[[</span><span class="st">"B02"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="v10-transf_files/figure-html/unnamed-chunk-9-2.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_f_1000m</span><span class="op">[[</span><span class="st">"B02"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="v10-transf_files/figure-html/unnamed-chunk-9-3.png" width="700"></p>
<p>In the previous images we can see that the first raster is the result
of the fusion of the two following rasters.</p>
</div>
</div>
<div class="section level2">
<h2 id="band-selection">Band selection<a class="anchor" aria-label="anchor" href="#band-selection"></a>
</h2>
<p>First, we query the bands available for each spatial resolution;
next, we select the bands and spatial resolutions we need.</p>
<div class="section level3">
<h3 id="get-available-bands">Get available bands<a class="anchor" aria-label="anchor" href="#get-available-bands"></a>
</h3>
<p>In the previous section we have used the
<code><a href="../reference/get_spatial_resolution.html">get_spatial_resolution()</a></code> function to obtain the available
spatial resolutions. We show it again below.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sr_all</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_spatial_resolution.html">get_spatial_resolution</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "r1000m" "r2000m" "r6000m"</span></span></code></pre></div>
<p>We can consult the bands available for one or more spatial
resolutions. By default they are obtained for all available resolutions,
as we can see below.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sr_all</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_band_names.html">get_band_names</a></span><span class="op">(</span>res <span class="op">=</span> <span class="st">"r1000m"</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "AOT"            "B02"            "B03"            "B04"           </span></span>
<span><span class="co">#&gt;  [5] "B08"            "MSK_DETFOO_B02" "MSK_DETFOO_B03" "MSK_DETFOO_B04"</span></span>
<span><span class="co">#&gt;  [9] "MSK_DETFOO_B08" "WVP"</span></span>
<span></span>
<span><span class="va">sr_all</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_band_names.html">get_band_names</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "AOT"            "B01"            "B02"            "B03"           </span></span>
<span><span class="co">#&gt;  [5] "B04"            "B05"            "B06"            "B07"           </span></span>
<span><span class="co">#&gt;  [9] "B08"            "B09"            "B11"            "B12"           </span></span>
<span><span class="co">#&gt; [13] "B8A"            "MSK_CLDPRB"     "MSK_DETFOO_B01" "MSK_DETFOO_B02"</span></span>
<span><span class="co">#&gt; [17] "MSK_DETFOO_B03" "MSK_DETFOO_B04" "MSK_DETFOO_B05" "MSK_DETFOO_B06"</span></span>
<span><span class="co">#&gt; [21] "MSK_DETFOO_B07" "MSK_DETFOO_B08" "MSK_DETFOO_B09" "MSK_DETFOO_B10"</span></span>
<span><span class="co">#&gt; [25] "MSK_DETFOO_B11" "MSK_DETFOO_B12" "MSK_DETFOO_B8A" "MSK_SNWPRB"    </span></span>
<span><span class="co">#&gt; [29] "SCL"            "WVP"</span></span></code></pre></div>
<p>Similarly, we can also limit the query to the available spectral
bands, as shown below.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sr_all</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_spectral_band_names.html">get_spectral_band_names</a></span><span class="op">(</span>res <span class="op">=</span> <span class="st">"r1000m"</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "B02" "B03" "B04" "B08"</span></span>
<span></span>
<span><span class="va">sr_all</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_spectral_band_names.html">get_spectral_band_names</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "B01" "B02" "B03" "B04" "B05" "B06" "B07" "B08" "B09" "B11" "B12" "B8A"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="select-bands">Select bands<a class="anchor" aria-label="anchor" href="#select-bands"></a>
</h3>
<p>Once we know the spatial resolutions and available bands, we can
generate a new <code>satres</code> object by selecting only some of them
using the <code><a href="../reference/select_bands.html">select_bands()</a></code> function. If any of the parameters
are not indicated, by default it considers all available values, as
shown in the following examples.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sr_sel1</span> <span class="op">&lt;-</span> <span class="va">sr_all</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_bands.html">select_bands</a></span><span class="op">(</span>res <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"r2000m"</span>, <span class="st">"r6000m"</span><span class="op">)</span>,</span>
<span>               bands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B01"</span>, <span class="st">"B02"</span>, <span class="st">"B03"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sr_sel1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_spatial_resolution.html">get_spatial_resolution</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "r2000m" "r6000m"</span></span>
<span><span class="va">sr_sel1</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_band_names.html">get_band_names</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "B01" "B02" "B03"</span></span>
<span></span>
<span><span class="va">sr_sel2</span> <span class="op">&lt;-</span> <span class="va">sr_all</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/select_bands.html">select_bands</a></span><span class="op">(</span>bands <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"B01"</span>, <span class="st">"B02"</span>, <span class="st">"B03"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">sr_sel2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_spatial_resolution.html">get_spatial_resolution</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "r1000m" "r2000m" "r6000m"</span></span>
<span><span class="va">sr_sel2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_band_names.html">get_band_names</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "B01" "B02" "B03"</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="other-transformation-functions">Other transformation functions<a class="anchor" aria-label="anchor" href="#other-transformation-functions"></a>
</h2>
<p>In addition to selecting the bands that we need to work together, we
can perform other transformation operations, such as merging the bands
that are tiles of the same raster, and clipping all the bands using a
polygon as a template.</p>
<div class="section level3">
<h3 id="merge-tiles">Merge tiles<a class="anchor" aria-label="anchor" href="#merge-tiles"></a>
</h3>
<p>In section <a href="#creation-of-objects-of-the-satres-class">“Creation of objects of
the <code>satres</code> class”</a>, we have obtained the data of the
area of interest by merging the rasters (in variable <code>sr</code>)
and also in separate rasters (in variables <code>sr_f</code> and
<code>sr_g</code>).</p>
<p>We can merge the individually obtained rasters to form a new object
of the <code>satres</code> class, as shown below.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sr2</span> <span class="op">&lt;-</span> <span class="va">sr_f</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/merge_tiles.html">merge_tiles</a></span><span class="op">(</span><span class="va">sr_g</span><span class="op">)</span></span></code></pre></div>
<p>Next, we can check that the result is the same as if we had performed
the fusion when creating the original object.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_1000m</span><span class="op">[[</span><span class="st">"B02"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="v10-transf_files/figure-html/unnamed-chunk-15-1.png" width="700"></p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">r2_1000m</span> <span class="op">&lt;-</span> <span class="va">sr2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/as_SpatRaster.html">as_SpatRaster</a></span><span class="op">(</span><span class="st">"r1000m"</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r2_1000m</span><span class="op">[[</span><span class="st">"B02"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="v10-transf_files/figure-html/unnamed-chunk-15-2.png" width="700"></p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="va">sr</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_spatial_resolution.html">get_spatial_resolution</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "r1000m" "r2000m" "r6000m"</span></span>
<span><span class="va">sr</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_band_names.html">get_band_names</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "B01" "B02" "B03" "B04" "B05" "B06" "B07" "B08" "B09" "B11" "B12" "B8A"</span></span>
<span></span>
<span><span class="va">sr2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_spatial_resolution.html">get_spatial_resolution</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "r1000m" "r2000m" "r6000m"</span></span>
<span><span class="va">sr2</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/get_band_names.html">get_band_names</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "B01" "B02" "B03" "B04" "B05" "B06" "B07" "B08" "B09" "B11" "B12" "B8A"</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="clip-bands">Clip bands<a class="anchor" aria-label="anchor" href="#clip-bands"></a>
</h3>
<p>Our objective to obtain and merge the bands is to study the area of
the municipality of Lanjarón. We can clip all rasters using a polygon
that represents the area of interest. In this case, we are going to use
the polygon that defines the outline of this municipality.</p>
<p>As described in section [“Datos”][Datos], we have included a file in
<em>GeoPackage</em> format in the package, whose name is in the
<code>lanjaron_gpkg</code> variable. We read the <em>GeoPackage</em>
layer we need, as shown below.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lanjaron</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_read.html" class="external-link">st_read</a></span><span class="op">(</span><span class="va">lanjaron_gpkg</span>, layer <span class="op">=</span> <span class="st">"lanjaron"</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>To perform the clipping operation, the polygon can have any CRS, the
CRS that is maintained is that of the raster layers.</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sr_lanjaron</span> <span class="op">&lt;-</span> <span class="va">sr</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/clip_bands.html">clip_bands</a></span><span class="op">(</span>polygon <span class="op">=</span> <span class="va">lanjaron</span><span class="op">)</span></span></code></pre></div>
<p>To show the result, we obtain an object of class Z and display one of
the raster layers along with the vector layer used to clip them, as can
be seen below.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">r_lanjaron_1000m</span> <span class="op">&lt;-</span> <span class="va">sr_lanjaron</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="../reference/as_SpatRaster.html">as_SpatRaster</a></span><span class="op">(</span><span class="st">"r1000m"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_lanjaron_1000m</span><span class="op">[[</span><span class="st">"B02"</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="fu">sf</span><span class="fu">::</span><span class="fu"><a href="https://r-spatial.github.io/sf/reference/st_geometry.html" class="external-link">st_geometry</a></span><span class="op">(</span><span class="va">lanjaron</span><span class="op">)</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p><img src="v10-transf_files/figure-html/unnamed-chunk-18-1.png" width="700"></p>
<p>The raster layer has such a coarse granularity because of the
transformation we performed to be able to store it in the package.</p>
<p>To show the bands available at the selected spatial resolution, we
represent them graphically below.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu">terra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/terra/man/plot.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">r_lanjaron_1000m</span><span class="op">)</span></span></code></pre></div>
<p><img src="v10-transf_files/figure-html/bands-1.png" width="700"></p>
</div>
</div>
<div class="section level2">
<h2 id="conclusion">Conclusion<a class="anchor" aria-label="anchor" href="#conclusion"></a>
</h2>
<p>In this document we have shown how to query and transform the
<code>satres</code> class objects obtained from reading raster
files.</p>
<p>We can select a subset of the available bands and spatial
resolutions, we can also merge them and clip them using a polygon.</p>
<p>Additionally, we can save them to files using the
<code><a href="../reference/save_by_resolution.html">save_by_resolution()</a></code> function, as shown in <em>Grouping
satellite bands by spectral and spatial resolution</em>,
<code><a href="../articles/satres.html">vignette("satres")</a></code>.</p>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Jose Samos.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
