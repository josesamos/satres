test_that("clip_bands()", {
  expect_equal({
    file <- system.file("extdata", "lanjaron.gpkg", package = "satres")
    lanjaron <- sf::st_read(file, layer = "lanjaron_bbox", quiet = TRUE)

    esa <- system.file("extdata", "esa", package = "satres")
    sr <- satres(dir = esa) |>
      clip_bands(polygon = lanjaron)

    c(sat_dimensions(sr),
      sat_names(sr),
      sat_minmax(sr))
  },
  c(
    "r1000m",
    "12",
    "19",
    "4",
    "r2000m",
    "6",
    "9",
    "10",
    "r6000m",
    "2",
    "3",
    "11",
    "r1000m",
    "B02",
    "B03",
    "B04",
    "B08",
    "r2000m",
    "B01",
    "B02",
    "B03",
    "B04",
    "B05",
    "B06",
    "B07",
    "B11",
    "B12",
    "B8A",
    "r6000m",
    "B01",
    "B02",
    "B03",
    "B04",
    "B05",
    "B06",
    "B07",
    "B09",
    "B11",
    "B12",
    "B8A",
    "r1000m",
    "1377.03",
    "2294.93",
    "1564.25",
    "2620.98",
    "1557.08",
    "2817.55",
    "2398.98",
    "3953.01",
    "r2000m",
    "1361.18",
    "2020.58",
    "1451.86",
    "2131.65",
    "1670.77",
    "2425.96",
    "1724.69",
    "2579.39",
    "2070.33",
    "2894.36",
    "2540.32",
    "3458.07",
    "2575.47",
    "3675.26",
    "2527.24",
    "3607.11",
    "2032.95",
    "3015.94",
    "2568.8",
    "3890.4",
    "r6000m",
    "1458.41",
    "1746.39",
    "1582.67",
    "1854.04",
    "1838.68",
    "2167.22",
    "1959.1",
    "2332",
    "2293.19",
    "2697.37",
    "2793.66",
    "3224.43",
    "2948.2",
    "3400.28",
    "3085.09",
    "3739.77",
    "2783.35",
    "3382.88",
    "2265.91",
    "2813.72",
    "3036.8",
    "3581.33"
  ))
})


test_that("select_bands()", {
  expect_equal({
    esa <- system.file("extdata", "esa", package = "satres")
    sr <- satres(dir = esa) |>
      select_bands(res = c("r1000m", "r6000m"),
                   bands = c("B01", "B03", "B04"))
    c(sat_dimensions(sr),
      sat_names(sr),
      sat_minmax(sr))
  },
  c(
    "r1000m",
    "110",
    "210",
    "2",
    "r6000m",
    "19",
    "36",
    "3",
    "r1000m",
    "B03",
    "B04",
    "r6000m",
    "B01",
    "B03",
    "B04",
    "r1000m",
    "1062.36",
    "8836.69",
    "1050.82",
    "8734.01",
    "r6000m",
    "1251.86",
    "3763.15",
    "1121.75",
    "3218.35",
    "1075.11",
    "3596.14"
  ))
})

test_that("select_bands()", {
  expect_equal({
    esa <- system.file("extdata", "esa", package = "satres")
    sr <- satres(dir = esa) |>
      select_bands(res = c("r1000m", "r6000m"))
    c(sat_dimensions(sr),
      sat_names(sr),
      sat_minmax(sr))
  },
  c(
    "r1000m",
    "110",
    "210",
    "4",
    "r6000m",
    "19",
    "36",
    "11",
    "r1000m",
    "B02",
    "B03",
    "B04",
    "B08",
    "r6000m",
    "B01",
    "B02",
    "B03",
    "B04",
    "B05",
    "B06",
    "B07",
    "B09",
    "B11",
    "B12",
    "B8A",
    "r1000m",
    "1053.38",
    "9115.54",
    "1062.36",
    "8836.69",
    "1050.82",
    "8734.01",
    "1051.04",
    "9087.86",
    "r6000m",
    "1251.86",
    "3763.15",
    "1192.94",
    "3464.1",
    "1121.75",
    "3218.35",
    "1075.11",
    "3596.14",
    "1071.99",
    "3989.81",
    "1062.55",
    "4268.05",
    "1062.08",
    "4457.01",
    "1040.85",
    "7290.28",
    "1062.18",
    "5576.82",
    "1057.33",
    "4720.68",
    "1063.86",
    "4707.62"
  ))
})

test_that("select_bands()", {
  expect_equal({
    esa <- system.file("extdata", "esa", package = "satres")
    sr <- satres(dir = esa) |>
      select_bands(bands = c("B01", "B03", "B04"))
    c(sat_dimensions(sr),
      sat_names(sr),
      sat_minmax(sr))
  },
  c(
    "r1000m",
    "110",
    "210",
    "2",
    "r2000m",
    "55",
    "105",
    "3",
    "r6000m",
    "19",
    "36",
    "3",
    "r1000m",
    "B03",
    "B04",
    "r2000m",
    "B01",
    "B03",
    "B04",
    "r6000m",
    "B01",
    "B03",
    "B04",
    "r1000m",
    "1062.36",
    "8836.69",
    "1050.82",
    "8734.01",
    "r2000m",
    "1153.42",
    "5188.09",
    "1097.98",
    "4579.82",
    "1066.95",
    "4578.87",
    "r6000m",
    "1251.86",
    "3763.15",
    "1121.75",
    "3218.35",
    "1075.11",
    "3596.14"
  ))
})
